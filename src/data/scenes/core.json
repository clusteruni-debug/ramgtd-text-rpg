[
  {
    "id": "core_train",
    "type": "dialogue",
    "background": "corridor",
    "speaker": null,
    "text": "중앙행 열차.\n\n열차 안에는 아무도 없다. 좌석이 모두 하얗다. 창밖에 — 도시의 내부가 보인다.\n\n파이프와 톱니바퀴, 끝없이 이어지는 배관. 이 도시의 내장이다.\n\n열차가 느려진다. 안내 방송이 흘러나온다.\n\n'다음 역 — 종착. 심연의 중추. 하차하시기 바랍니다.'\n\n'참고: 하차 후 복귀 열차는 없습니다.'",
    "choices": [
      {
        "text": "하차한다",
        "nextScene": "core_entrance"
      }
    ]
  },
  {
    "id": "core_entrance",
    "type": "dialogue",
    "background": "boss",
    "speaker": null,
    "text": "심연의 중추.\n\n거대한 검은 탑의 내부. 서버실 같기도 하고, 시청 같기도 하고, 법정 같기도 하다.\n\n차가운 청백색 조명이 끝없이 이어지는 복도를 비춘다. 벽에 모니터들이 빼곡하다. 각 모니터에 — 도시 곳곳의 영혼들이 보인다.\n\n텐트촌의 영혼들. 구역에서 풀려난 영혼들. 그리고 — 당신의 동료들.\n\n복도 끝에 거대한 문이 있다. '시장실'.",
    "effects": [
      { "type": "setFlag", "flag": "entered_core" }
    ],
    "choices": [
      {
        "text": "시장실로 들어간다",
        "nextScene": "core_mayor_intro"
      }
    ]
  },
  {
    "id": "core_mayor_intro",
    "type": "dialogue",
    "background": "boss",
    "speaker": "mayor",
    "text": "시장실.\n\n방 한가운데에 거대한 의자 — 아니, 서버 — 아니, 왕좌가 있다. 케이블과 배관이 천장까지 이어진다.\n\n그 위에 앉아있는 존재.\n\n시장. 겉보기에는 평범한 정장을 입은 중년. 하지만 눈이 없다. 눈 자리에 스크린이 있고, 데이터가 흐르고 있다.\n\n\"오류 코드 #0000.\"\n\n\"처리 불가 데이터. 분해 실패. 재부팅 반복.\"\n\n\"드디어 왔군. 기다렸다.\"",
    "choices": [
      {
        "text": "\"기다렸다고?\"",
        "nextScene": "core_mayor_talk_01"
      },
      {
        "text": "\"이 도시를 끝내러 왔어.\"",
        "nextScene": "core_mayor_talk_02"
      }
    ]
  },
  {
    "id": "core_mayor_talk_01",
    "type": "dialogue",
    "background": "boss",
    "speaker": "mayor",
    "text": "\"이 도시는 완벽했다.\"\n\n시장의 스크린 눈에 그래프가 뜬다. 우상향.\n\n\"감정을 분류하고, 압축하고, 소각하고, 동결한다. 효율 99.7%. 도시는 자급자족한다.\"\n\n\"그런데 네가 왔다. 처리할 수 없는 데이터. 비어있는 영혼.\"\n\n\"네가 지나간 자리마다 시스템이 오류를 일으켰다. 프레스가 멈추고. 침묵이 깨지고. 얼음이 녹고. 불이 꺼졌다.\"\n\n\"...효율이 72%까지 떨어졌어.\"",
    "choices": [
      {
        "text": "\"효율이 아니라 사람이 중요한 거야\"",
        "nextScene": "core_mayor_talk_03"
      },
      {
        "text": "\"그래서? 나를 처리하겠다고?\"",
        "nextScene": "core_mayor_talk_03"
      }
    ]
  },
  {
    "id": "core_mayor_talk_02",
    "type": "dialogue",
    "background": "boss",
    "speaker": "mayor",
    "text": "\"끝낸다?\"\n\n시장이 고개를 갸웃한다. 스크린 눈에 물음표가 뜬다.\n\n\"이 도시는 필요해서 존재한다. 현실 세계의 감정 쓰레기를 처리하는 시설이야.\"\n\n\"네가 이 도시를 '끝내면' — 현실 세계의 부정적 감정은 어디로 가지?\"\n\n\"...다시 사람들에게로 돌아간다. 처리되지 않은 채로.\"\n\n시장이 일어선다.\n\n\"이 도시는 완벽하다. 네가 가진 그 불필요한 자아(기억)만 빼면.\"",
    "choices": [
      {
        "text": "\"완벽한 시스템 따위 필요 없어\"",
        "nextScene": "core_mayor_talk_03"
      }
    ]
  },
  {
    "id": "core_mayor_talk_03",
    "type": "dialogue",
    "background": "boss",
    "speaker": "mayor",
    "text": "시장이 일어선다. 케이블들이 따라 올라간다.\n\n\"마지막 기회를 주겠다.\"\n\n\"기억을 모두 내놓으면 — 현실로 돌려보내준다. 깨끗한 상태로. 아무것도 기억하지 못하는 채로.\"\n\n\"아니면 —\"\n\n스크린 눈이 빨갛게 변한다.\n\n\"포맷한다.\"",
    "choices": [
      {
        "text": "\"거부한다. 싸우겠어.\"",
        "nextScene": "core_mayor_battle"
      },
      {
        "text": "\"...좋아. 기억을 내놓을게.\" (속임수)",
        "check": { "stat": "reason", "dc": 8 },
        "nextScene": "core_mayor_battle"
      }
    ]
  },
  {
    "id": "core_mayor_battle",
    "type": "combat",
    "background": "boss",
    "enemy": "mayor",
    "introText": "시장이 팔을 벌린다. 서버실 전체가 가동된다.\n\n\"관리자 권한으로 — 오류 코드 #0000 — 포맷을 집행한다.\"",
    "victoryScene": "core_mayor_victory",
    "rewards": { "engrams": 50 },
    "rounds": [
      {
        "text": "시장이 데이터 스트림을 발사한다! 모니터에서 쏟아지는 빛줄기가 당신을 향한다.\n\n\"1차 포맷 — 표층 데이터 삭제.\"",
        "choices": [
          {
            "text": "데이터 스트림 사이를 피한다",
            "check": { "stat": "sense", "dc": 6 },
            "alignment": "neutral",
            "karmaShift": 0,
            "success": { "text": "빛줄기 사이를 날렵하게 빠져나간다!", "effects": [] },
            "failure": { "text": "빛줄기에 맞았다. 잠시 기억이 흐려진다.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -5 }] }
          },
          {
            "text": "데이터 코드를 분석해 방화벽을 만든다",
            "check": { "stat": "reason", "dc": 7 },
            "alignment": "neutral",
            "karmaShift": 0,
            "success": { "text": "시장의 코드 패턴을 읽고 역으로 방어벽을 구축한다!", "effects": [{ "type": "setFlag", "flag": "mayor_firewall_built" }] },
            "failure": { "text": "코드가 너무 복잡하다. 해독에 실패.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -6 }] }
          },
          {
            "text": "기억으로 맞선다 — 가장 소중한 기억을 떠올린다",
            "check": { "stat": "bond", "dc": 7 },
            "alignment": "light",
            "karmaShift": 5,
            "success": { "text": "동료들과의 기억이 방패가 된다. 데이터 스트림이 튕겨나간다!", "effects": [] },
            "failure": { "text": "기억이 흐릿하다. 방패가 약하다.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -5 }] }
          }
        ]
      },
      {
        "text": "시장이 서버실의 중력을 조작한다. 천장과 바닥이 뒤바뀐다!\n\n\"2차 포맷 — 공간 인식 초기화. 위아래를 잊어라.\"",
        "choices": [
          {
            "text": "케이블을 잡고 이동한다",
            "check": { "stat": "body", "dc": 6 },
            "alignment": "neutral",
            "karmaShift": 0,
            "success": { "text": "케이블을 타고 원숭이처럼 이동한다! 중력이 바뀌어도 상관없다.", "effects": [] },
            "failure": { "text": "케이블이 끊어진다. 바닥(천장?)에 추락한다.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -7 }] }
          },
          {
            "text": "눈을 감고 감각에 의존한다",
            "check": { "stat": "sense", "dc": 7 },
            "alignment": "neutral",
            "karmaShift": 0,
            "success": { "text": "시각을 버리고 감각에 집중한다. 중력이 바뀌어도 몸이 알아서 움직인다.", "effects": [] },
            "failure": { "text": "감각마저 혼란스럽다. 벽에 부딪힌다.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -6 }] }
          },
          {
            "text": "\"네 도시도 원래는 위아래가 있었을 텐데\"",
            "check": { "stat": "bond", "dc": 8 },
            "alignment": "light",
            "karmaShift": 5,
            "success": { "text": "시장의 동작이 멈칫한다. 중력이 잠시 정상으로 돌아온다.", "effects": [] },
            "failure": { "text": "시장은 동요하지 않는다. 중력이 더 세게 뒤집힌다.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -7 }] }
          }
        ]
      },
      {
        "text": "시장이 얼굴의 스크린을 벗긴다. 그 아래에 — 사람의 얼굴이 있다. 피곤하고 슬픈 얼굴.\n\n\"3차 포맷 — 감정 데이터 삭제.\"\n\n시장이 방 전체에 '무(無)'의 파동을 보낸다. 모든 감정이 사라지는 느낌.",
        "choices": [
          {
            "text": "분노로 맞선다",
            "check": { "stat": "body", "dc": 7 },
            "alignment": "dark",
            "karmaShift": -5,
            "success": { "text": "이를 악물고 돌진한다. 감정이 사라지기 전에 — 분노만으로 시장에게 닿는다!", "effects": [] },
            "failure": { "text": "분노마저 사라진다. 무력해진다.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -8 }] }
          },
          {
            "text": "시장의 약점 — 사람의 얼굴 — 을 노린다",
            "check": { "stat": "reason", "dc": 7 },
            "alignment": "neutral",
            "karmaShift": 0,
            "success": { "text": "스크린이 아닌 진짜 얼굴. 거기에 감정이 남아있다. 시장의 시스템에 버그를 만든다!", "effects": [] },
            "failure": { "text": "시장이 다시 스크린을 올린다. 틈이 사라졌다.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -6 }] }
          },
          {
            "text": "\"넌 왜 이 일을 하는 거야? 진짜 이유가 뭐야?\"",
            "check": { "stat": "bond", "dc": 6 },
            "alignment": "light",
            "karmaShift": 8,
            "success": { "text": "시장의 진짜 얼굴이 — 운다.\n\"...나도 몰라. 처음엔 이유가 있었는데. 너무 오래돼서.\"\n무의 파동이 약해진다.", "effects": [] },
            "failure": { "text": "\"이유는 효율이다. 감정은 불필요하다.\" 파동이 강해진다.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -7 }] }
          }
        ]
      },
      {
        "text": "시장이 마지막 힘을 모은다. 서버실 전체가 빛난다.\n\n\"최종 포맷 — 대상: 오류 코드 #0000. 존재 데이터 완전 삭제.\"\n\n\"이 도시의 모든 처리 능력을 너 하나에게 집중한다.\"\n\n방 전체가 하얗게 변한다.",
        "choices": [
          {
            "text": "서버의 메인 케이블을 뽑는다",
            "check": { "stat": "reason", "dc": 8 },
            "alignment": "neutral",
            "karmaShift": 0,
            "success": { "text": "케이블 다발 중 가장 두꺼운 것을 잡아 뽑는다! 서버실이 어두워지고, 시장의 힘이 소멸한다.", "effects": [] },
            "failure": { "text": "케이블이 전기로 감전시킨다!", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -10 }] }
          },
          {
            "text": "포맷을 정면으로 받아낸다 — 빈 영혼은 삭제할 수 없다",
            "check": { "stat": "body", "dc": 8 },
            "alignment": "dark",
            "karmaShift": -3,
            "success": { "text": "하얀 빛이 온몸을 관통한다. 하지만 — 지울 데이터가 없다. 시스템이 에러를 반복한다.\n\"Processing Error. Processing Error.\"\n시장이 무너진다.", "effects": [] },
            "failure": { "text": "빛이 기억 일부를 태운다. 참을 수 없는 고통.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -10 }] }
          },
          {
            "text": "모든 동료의 이름을 부른다",
            "check": { "stat": "bond", "dc": 7 },
            "alignment": "light",
            "karmaShift": 10,
            "success": { "text": "\"민준. 소연. 그리고 —\"\n\n이름을 부를 때마다 빛이 약해진다. 기억은 지울 수 없다. 관계는 삭제할 수 없다.\n\n시장이 무릎을 꿇는다.", "effects": [] },
            "failure": { "text": "이름이... 생각나지 않는다. 기억이 흐려진다.", "effects": [{ "type": "modifyStat", "stat": "hp", "value": -8 }] }
          }
        ]
      }
    ]
  },
  {
    "id": "core_mayor_victory",
    "type": "dialogue",
    "background": "boss",
    "speaker": "mayor",
    "text": "서버실이 어두워진다.\n\n시장이 바닥에 앉아있다. 스크린 얼굴이 깨져서, 아래의 사람 얼굴이 보인다.\n\n늙고 피곤한 얼굴. 수천 년을 일한 공무원의 얼굴.\n\n\"...시스템 오류. 복구 불가.\"\n\n\"너는 진짜 오류야. 처리할 수도 없고, 분류할 수도 없고.\"\n\n\"하지만 —\"\n\n그가 작게 웃는다.\n\n\"그래서 이 도시가 멈춘 거겠지. 처리할 수 없는 것이 — 가장 인간적인 것이니까.\"\n\n벽 뒤에 문이 나타난다. 마지막 문.",
    "effects": [
      { "type": "setFlag", "flag": "boss_mayor_defeated" },
      { "type": "addEngrams", "value": 50 },
      { "type": "addAbyssMemory", "id": "mem_mayor_smile", "label": "시장의 마지막 미소", "weight": 5, "source": "core" }
    ],
    "choices": [
      {
        "text": "마지막 문을 연다",
        "nextScene": "ending_gate"
      }
    ]
  }
]
